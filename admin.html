<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUNLET Admin V12.1</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* (ìŠ¤íƒ€ì¼ì€ V12ì™€ ë™ì¼í•©ë‹ˆë‹¤) */
        :root { --sidebar-w: 260px; --primary: #00ff9d; --bg: #121212; --panel: #1e1e1e; --danger: #ff4757; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Noto Sans KR'; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: var(--sidebar-w); background: #1a1a1a; border-right: 1px solid #333; display: flex; flex-direction: column; padding: 20px; box-sizing: border-box; flex-shrink: 0; }
        .logo { font-size: 1.5rem; color: var(--primary); font-weight: bold; margin-bottom: 30px; display: flex; align-items: center; gap: 10px; }
        .menu-item { padding: 15px; color: #aaa; cursor: pointer; border-radius: 10px; margin-bottom: 5px; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-weight: 500; }
        .menu-item:hover, .menu-item.active { background: rgba(0, 255, 157, 0.1); color: var(--primary); }
        .content { flex: 1; padding: 40px; overflow-y: auto; background: var(--bg); position: relative; }
        .page { display: none; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        h2 { border-bottom: 2px solid #333; padding-bottom: 15px; margin-top: 0; color: var(--primary); }
        .card { background: #222; padding: 20px; border-radius: 10px; border: 1px solid #333; margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #ccc; font-size: 0.9rem; }
        input, select, textarea { width: 100%; padding: 12px; background: #111; border: 1px solid #444; color: white; border-radius: 8px; box-sizing: border-box; margin-bottom: 10px; font-family: inherit; }
        textarea.code-editor { font-family: 'Consolas', monospace; line-height: 1.5; color: #a6e22e; background: #0f0f0f; height: 400px; tab-size: 4; }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); outline: none; }
        button { padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; border: none; font-size: 0.9rem; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: black; width: 100%; padding: 15px; font-size: 1.1rem; }
        .btn-primary:hover { background: #00cc7d; }
        .btn-danger { background: var(--danger); color: white; width: auto; padding: 5px 10px; font-size: 0.8rem; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; width: auto; background: #444; color: white; }
        .list-row { display: flex; gap: 10px; align-items: center; background: #2a2a2a; padding: 10px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #333; }
        .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 15px; margin-top: 15px; }
        .file-card { background: #2a2a2a; border: 1px solid #444; border-radius: 10px; padding: 10px; text-align: center; cursor: pointer; transition: 0.2s; position: relative; }
        .file-card:hover { border-color: var(--primary); transform: translateY(-3px); }
        .file-card img { width: 100%; height: 80px; object-fit: contain; background: #000; border-radius: 5px; margin-bottom: 5px; }
        .file-name { font-size: 0.75rem; color: #ddd; word-break: break-all; }
        .radio-group { display: flex; gap: 20px; margin-bottom: 15px; background: #1a1a1a; padding: 15px; border-radius: 8px; }
        .radio-group label { cursor: pointer; display: flex; align-items: center; gap: 5px; color:white; }
        input[type="radio"] { width: auto; margin: 0; }
        .loading { text-align: center; color: #888; padding: 20px; }
        
        /* [NEW] ë³µì‚¬ ì•Œë¦¼ í† ìŠ¤íŠ¸ */
        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 5px; padding: 16px; position: fixed; z-index: 9999; left: 50%; bottom: 30px; transform: translateX(-50%); box-shadow: 0 5px 15px rgba(0,0,0,0.5); border: 1px solid #00ff9d; }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="logo"><i class="fa-solid fa-gamepad"></i> FUNLET V12.1</div>
        <div class="menu-item active" onclick="goPage('game')"><i class="fa-solid fa-code"></i> ê²Œì„/ì½”ë“œ ê´€ë¦¬</div>
        <div class="menu-item" onclick="goPage('category')"><i class="fa-solid fa-list"></i> ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</div>
        <div class="menu-item" onclick="goPage('ad-manager')"><i class="fa-solid fa-sack-dollar"></i> ê´‘ê³  ìˆ˜ìµí™” ê´€ë¦¬</div>
        <div class="menu-item" onclick="goPage('assets')"><i class="fa-solid fa-folder-open"></i> ìì‚°(ì´ë¯¸ì§€/ì†Œë¦¬)</div>
        <div style="margin-top:auto;">
            <label>ğŸ”‘ ê´€ë¦¬ì í† í°</label>
            <input type="password" id="token" placeholder="ghp_..." onchange="saveToken()">
            <button onclick="loadAllData()" class="btn-primary" style="margin-top:10px; background:#444; color:white; font-size:0.9rem;">ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </div>

    <div class="content">
        <div id="page-game" class="page active">
            <h2>ğŸ® ê²Œì„ ì •ë³´ ë° ì½”ë“œ ìˆ˜ì •</h2>
            <div class="card">
                <div class="form-group">
                    <label>ìˆ˜ì •í•  ê²Œì„ ì„ íƒ</label>
                    <select id="gameSelector" onchange="selectGameForEdit()"><option value="">-- ì‹ ê·œ ê²Œì„ ë§Œë“¤ê¸° --</option></select>
                </div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top:15px;">
                    <div><label>ê²Œì„ ID (í´ë”ëª…)</label><input type="text" id="gId" placeholder="ì˜ˆ: space-merge"></div>
                    <div><label>ê²Œì„ ì œëª©</label><input type="text" id="gTitle" placeholder="ì˜ˆ: ìš°ì£¼ í•©ì¹˜ê¸°"></div>
                </div>
                <label>ì¹´í…Œê³ ë¦¬</label><select id="gCategory"><option>ë¡œë”© ì¤‘...</option></select>
                <label>ì¸ë„¤ì¼ ê²½ë¡œ</label>
                <div style="display:flex; gap:10px;">
                    <input type="text" id="gThumbPath" placeholder="ì´ë¯¸ì§€ ê²½ë¡œ">
                    <button class="btn-sm" onclick="goPage('assets')">ì´ë¯¸ì§€ ì°¾ìœ¼ëŸ¬ ê°€ê¸°</button>
                </div>
                <hr style="border:0; border-top:1px solid #444; margin: 20px 0;">
                <label>ğŸ’» ê²Œì„ HTML ì½”ë“œ</label>
                <textarea id="gCode" class="code-editor" placeholder="ì½”ë“œê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤."></textarea>
                <button class="btn-primary" onclick="saveGameData()" style="margin-top:10px;">ëª¨ë“  ë³€ê²½ì‚¬í•­ ì €ì¥</button>
            </div>
        </div>

        <div id="page-category" class="page">
            <h2>ğŸ“‚ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ <button class="btn-sm" onclick="addCategoryRow()">+ ì¶”ê°€</button></h2>
            <div id="categoryList"></div>
            <button class="btn-primary" onclick="saveCategories()" style="margin-top:20px;">ë³€ê²½ì‚¬í•­ ì €ì¥</button>
        </div>

        <div id="page-ad-manager" class="page">
            <h2>ğŸ’° ê´‘ê³  ìˆ˜ìµí™” ê´€ë¦¬</h2>
            <div class="card">
                <label>1. ì„¤ì •í•  ê´‘ê³  ì˜ì—­ ì„ íƒ</label>
                <select id="adSlot" onchange="loadAdData()">
                    <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
                    <option value="mainTop">ğŸ–¥ï¸ ë©”ì¸ ìƒë‹¨ ë°°ë„ˆ</option>
                    <option value="gameBottom">ğŸ“± ê²Œì„ í•˜ë‹¨ ë°°ë„ˆ</option>
                    <option value="sidebar">â– ì‚¬ì´ë“œë°” ë°°ë„ˆ</option>
                    <option value="interstitial">âœ¨ [ì „ë©´ê´‘ê³ ] (ê²Œì„ ì¢…ë£Œ/ë¶€í™œ)</option>
                    <option value="hero">ğŸ–¼ï¸ ë©”ì¸ íƒ€ì´í‹€ ë°°ê²½</option>
                </select>
            </div>
            <div class="card" id="adEditArea" style="display:none;">
                <label>2. ê´‘ê³  íƒ€ì… ì„ íƒ</label>
                <div class="radio-group">
                    <label><input type="radio" name="adType" value="image" onclick="toggleAdType()" checked> ğŸ–¼ï¸ ì´ë¯¸ì§€ (ìì‚° íƒ­ì—ì„œ ì£¼ì†Œ ë³µì‚¬)</label>
                    <label><input type="radio" name="adType" value="code" onclick="toggleAdType()"> ğŸ“Ÿ ì½”ë“œ ì‚½ì… (ì• ë“œì„¼ìŠ¤/ì• ë“œí•)</label>
                </div>
                <div id="typeImage">
                    <label>ì´ë¯¸ì§€ URL (ìì‚° íƒ­ì—ì„œ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•´ì„œ ë³µì‚¬í•´ì˜¤ì„¸ìš”!)</label>
                    <input type="text" id="adImgUrl" placeholder="https://fun-let.github.io/funlet/images/...">
                    <label>ë§í¬ URL</label>
                    <input type="text" id="adLink" placeholder="https://...">
                </div>
                <div id="typeCode" style="display:none;">
                    <label>ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ</label>
                    <textarea id="adCode" style="height:150px; font-family:monospace; background:#000; color:#eee;"></textarea>
                </div>
                <button class="btn-primary" onclick="saveAdSetting()" style="margin-top:10px;">ì €ì¥í•˜ê¸°</button>
            </div>
        </div>

        <div id="page-assets" class="page">
            <h2>ğŸ–¼ï¸ ìì‚° ë° íŒŒì¼ ê´€ë¦¬</h2>
            <div class="card">
                <p style="color:#aaa; font-size:0.8rem;">* íŒŒì¼ì„ í´ë¦­í•˜ë©´ <b>[ì „ì²´ ì£¼ì†Œ]</b>ê°€ ë³µì‚¬ë©ë‹ˆë‹¤. ê´‘ê³  ê´€ë¦¬ë‚˜ ê²Œì„ ì„¤ì •ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
                <div style="display:flex; gap:10px;">
                    <select id="folderSelect" onchange="loadFolderFiles(this.value)" style="flex:1;"><option>ë¡œë”© ì¤‘...</option></select>
                    <button onclick="scanFolders()" class="btn-sm">ğŸ”„ ìŠ¤ìº”</button>
                </div>
            </div>
            <div class="card">
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="text" id="uploadName" placeholder="íŒŒì¼ëª… (ì˜ˆ: ad_popup.png)" style="flex:1;">
                    <input type="file" id="uploadFile" style="flex:1;">
                </div>
                <button class="btn-primary" onclick="uploadAsset()" style="margin-top:10px; padding:10px;">ì—…ë¡œë“œ</button>
            </div>
            <div id="fileGrid" class="file-grid"></div>
        </div>
    </div>

    <div id="toast">ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>

    <script>
        const USER = 'fun-let'; const REPO = 'funlet';
        let categories=[], games=[], adsData={}, catsSha=null, gamesSha=null, adsSha=null, currentPath="";

        window.onload = () => {
            const t = localStorage.getItem('token');
            if(t) { document.getElementById('token').value = t; loadAllData(); }
        }
        function saveToken() { localStorage.setItem('token', document.getElementById('token').value); loadAllData(); }
        function goPage(p) {
            document.querySelectorAll('.menu-item').forEach(e=>e.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.querySelectorAll('.page').forEach(e=>e.classList.remove('active'));
            document.getElementById('page-'+p).classList.add('active');
        }
        function showToast(msg) {
            const t = document.getElementById("toast");
            t.innerText = msg; t.className = "show";
            setTimeout(()=>{ t.className = t.className.replace("show", ""); }, 3000);
        }

        async function loadAllData() {
            const token = document.getElementById('token').value;
            if(!token) return;
            await Promise.all([loadCategories(), loadGames(), loadAdsJson(), scanFolders()]);
        }

        // --- 1. ê²Œì„ ---
        async function loadGames() { /* V12ì™€ ë™ì¼ */ 
            const token = document.getElementById('token').value;
            try {
                let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/data/games.json`, {headers:{Authorization:`token ${token}`}});
                let d = await res.json();
                gamesSha = d.sha;
                games = JSON.parse(decodeContent(d.content));
                updateGameSelector();
            } catch(e){}
        }
        function updateGameSelector() {
            const sel = document.getElementById('gameSelector');
            sel.innerHTML = '<option value="">-- ì‹ ê·œ ê²Œì„ ë§Œë“¤ê¸° --</option>';
            games.forEach((g, idx) => sel.innerHTML += `<option value="${idx}">[ìˆ˜ì •] ${g.title}</option>`);
        }
        async function selectGameForEdit() { /* V12ì™€ ë™ì¼ */ 
            const idx = document.getElementById('gameSelector').value;
            const codeArea = document.getElementById('gCode');
            if(idx === "") {
                document.getElementById('gId').value = ""; document.getElementById('gId').disabled = false;
                document.getElementById('gTitle').value = ""; codeArea.value = "";
                document.getElementById('gThumbPath').value = "";
            } else {
                const g = games[idx];
                document.getElementById('gId').value = g.id; document.getElementById('gId').disabled = true;
                document.getElementById('gTitle').value = g.title; document.getElementById('gCategory').value = g.category;
                document.getElementById('gThumbPath').value = g.thumb;
                try {
                    let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/games/${g.id}/index.html`, {headers:{Authorization:`token ${document.getElementById('token').value}`}});
                    let d = await res.json();
                    codeArea.value = decodeContent(d.content);
                } catch(e) { codeArea.value = "ì½”ë“œ ë¡œë“œ ì‹¤íŒ¨"; }
            }
        }
        async function saveGameData() { /* V12ì™€ ë™ì¼ */
            const id = document.getElementById('gId').value;
            const title = document.getElementById('gTitle').value;
            const code = document.getElementById('gCode').value;
            const catId = document.getElementById('gCategory').value;
            const thumb = document.getElementById('gThumbPath').value;
            const token = document.getElementById('token').value;
            if(!id || !title) return alert("IDì™€ ì œëª© í•„ìˆ˜");
            const catName = categories.find(c => c.id === catId)?.name || "ê¸°íƒ€";
            const newEntry = { id, title, category: catId, desc: catName, thumb };
            const idx = games.findIndex(g => g.id === id);
            if(idx > -1) games[idx] = newEntry; else games.push(newEntry);
            await uploadFile('data/games.json', JSON.stringify(games, null, 2), gamesSha, "Update Games");
            let codeSha = null;
            try {
                let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/games/${id}/index.html`, {headers:{Authorization:`token ${token}`}});
                if(res.ok) codeSha = (await res.json()).sha;
            } catch(e){}
            await uploadFile(`games/${id}/index.html`, code, codeSha, `Update Code`);
            alert("ì €ì¥ ì™„ë£Œ!"); loadGames();
        }

        // --- 2. ê´‘ê³  ---
        async function loadAdsJson() { /* V12ì™€ ë™ì¼ */
            const token = document.getElementById('token').value;
            try {
                let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/data/ads.json`, {headers:{Authorization:`token ${token}`}});
                let d = await res.json();
                adsSha = d.sha;
                adsData = JSON.parse(decodeContent(d.content));
            } catch(e){}
        }
        function loadAdData() { /* V12ì™€ ë™ì¼ */
            const slot = document.getElementById('adSlot').value;
            const area = document.getElementById('adEditArea');
            if(!slot) { area.style.display='none'; return; }
            area.style.display='block';
            const data = adsData[slot] || { type: 'image', content: '', link: '' };
            const radios = document.getElementsByName('adType');
            if(data.type === 'code') radios[1].checked = true; else radios[0].checked = true;
            toggleAdType();
            if(data.type === 'code') document.getElementById('adCode').value = data.content || '';
            else { document.getElementById('adImgUrl').value = data.content || ''; document.getElementById('adLink').value = data.link || ''; }
        }
        function toggleAdType() { /* V12ì™€ ë™ì¼ */
            const isCode = document.querySelector('input[name="adType"]:checked').value === 'code';
            document.getElementById('typeImage').style.display = isCode ? 'none' : 'block';
            document.getElementById('typeCode').style.display = isCode ? 'block' : 'none';
        }
        async function saveAdSetting() { /* V12ì™€ ë™ì¼ */
            const slot = document.getElementById('adSlot').value;
            const type = document.querySelector('input[name="adType"]:checked').value;
            if(!adsData[slot]) adsData[slot] = {};
            adsData[slot].type = type;
            if(type === 'code') { adsData[slot].content = document.getElementById('adCode').value; }
            else { adsData[slot].content = document.getElementById('adImgUrl').value; adsData[slot].link = document.getElementById('adLink').value; }
            await uploadFile('data/ads.json', JSON.stringify(adsData, null, 2), adsSha, "Update Ads");
            alert("ì €ì¥ ì™„ë£Œ!"); loadAdsJson();
        }

        // --- 3. ì¹´í…Œê³ ë¦¬ (V12ì™€ ë™ì¼) ---
        async function loadCategories() { /* ... */ 
            const token = document.getElementById('token').value;
            try {
                let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/data/categories.json`, {headers:{Authorization:`token ${token}`}});
                let d = await res.json();
                catsSha = d.sha;
                categories = JSON.parse(decodeContent(d.content));
                renderCategories();
                const sel = document.getElementById('gCategory');
                sel.innerHTML = "";
                categories.forEach(c => sel.innerHTML += `<option value="${c.id}">${c.name}</option>`);
            } catch(e){}
        }
        function renderCategories() { /* ... */ 
            const list = document.getElementById('categoryList');
            list.innerHTML = "";
            categories.forEach((c, idx) => {
                list.innerHTML += `<div class="list-row"><input value="${c.id}" onchange="categories[${idx}].id=this.value" style="width:20%"><input value="${c.name}" onchange="categories[${idx}].name=this.value" style="width:40%"><input value="${c.icon}" onchange="categories[${idx}].icon=this.value" style="width:30%"><button class="btn-danger" onclick="deleteCategory(${idx})">ì‚­ì œ</button></div>`;
            });
        }
        function addCategoryRow() { categories.push({id:"", name:"", icon:""}); renderCategories(); }
        function deleteCategory(idx) { if(confirm("ì‚­ì œ?")) { categories.splice(idx,1); renderCategories(); } }
        async function saveCategories() {
            await uploadFile('data/categories.json', JSON.stringify(categories, null, 2), catsSha, "Update Cat");
            alert("ì €ì¥ ì™„ë£Œ"); loadCategories();
        }

        // --- 4. ìì‚° ê´€ë¦¬ (ë³µì‚¬ ê¸°ëŠ¥ ê°•í™”!) ---
        async function scanFolders() {
            const token = document.getElementById('token').value;
            const sel = document.getElementById('folderSelect');
            sel.innerHTML = '<option>ìŠ¤ìº” ì¤‘...</option>';
            try {
                const dirs = ['images', 'audio', 'games'];
                sel.innerHTML = '<option value="">-- í´ë” ì„ íƒ --</option>';
                for(let d of dirs) {
                    let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${d}`, {headers:{Authorization:`token ${token}`}});
                    let data = await res.json();
                    sel.innerHTML += `<option value="${d}/">ğŸ“‚ ${d}/</option>`;
                    data.forEach(item => { if(item.type === 'dir') sel.innerHTML += `<option value="${item.path}/">   â”” ${item.name}/</option>`; });
                }
            } catch(e){}
        }
        async function loadFolderFiles(path) {
            if(!path) return;
            const token = document.getElementById('token').value;
            const grid = document.getElementById('fileGrid');
            grid.innerHTML = 'ë¡œë”© ì¤‘...';
            currentPath = path;
            try {
                const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`, {headers:{Authorization:`token ${token}`}});
                const data = await res.json();
                grid.innerHTML = '';
                data.forEach(item => {
                    if(item.type === 'file') {
                        const div = document.createElement('div');
                        div.className = 'file-card';
                        
                        // í’€ URL ìƒì„± (ì¤‘ìš”!)
                        const fullUrl = `https://${USER}.github.io/${REPO}/${item.path}`;
                        
                        if(item.name.match(/\.(png|jpg|gif)$/i)) div.innerHTML = `<img src="${item.download_url}"><div class="file-name">${item.name}</div>`;
                        else div.innerHTML = `<div style="font-size:2rem; margin-bottom:10px;">ğŸ“„</div><div class="file-name">${item.name}</div>`;
                        
                        // í´ë¦­ ì‹œ í’€ URL ë³µì‚¬
                        div.onclick = () => {
                            document.getElementById('uploadName').value = item.name;
                            navigator.clipboard.writeText(fullUrl);
                            showToast(`ì£¼ì†Œ ë³µì‚¬ë¨!\n${fullUrl}`);
                        };
                        grid.appendChild(div);
                    }
                });
            } catch(e){}
        }
        async function uploadAsset() {
            const name = document.getElementById('uploadName').value;
            const file = document.getElementById('uploadFile').files[0];
            if(!name || !file) return alert("ì •ë³´ í™•ì¸");
            const reader = new FileReader();
            reader.onload = async function() {
                const content = reader.result.split(',')[1];
                let sha = null;
                try {
                    let res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${currentPath}${name}`, {headers:{Authorization:`token ${document.getElementById('token').value}`}});
                    if(res.ok) sha = (await res.json()).sha;
                } catch(e){}
                await uploadRawFile(currentPath + name, content, sha);
                
                // ì—…ë¡œë“œ í›„ ì£¼ì†Œ ìë™ ë³µì‚¬
                const fullUrl = `https://${USER}.github.io/${REPO}/${currentPath}${name}`;
                alert("ì—…ë¡œë“œ ì„±ê³µ! ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
                navigator.clipboard.writeText(fullUrl);
                
                loadFolderFiles(currentPath);
            };
            reader.readAsDataURL(file);
        }

        // --- ìœ í‹¸ ---
        function decodeContent(b64) { return new TextDecoder().decode(Uint8Array.from(atob(b64), c=>c.charCodeAt(0))); }
        function encodeContent(str) { return btoa(unescape(encodeURIComponent(str))); }
        async function uploadFile(path, content, sha, msg) { /* V12ì™€ ë™ì¼ */ 
            const token = document.getElementById('token').value;
            const body = { message: msg, content: encodeContent(content) };
            if(sha) body.sha = sha;
            await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`, { method: 'PUT', headers: {'Authorization':`token ${token}`}, body: JSON.stringify(body) });
        }
        async function uploadRawFile(path, b64, sha) { /* V12ì™€ ë™ì¼ */
            const token = document.getElementById('token').value;
            const body = { message: "Upload", content: b64 };
            if(sha) body.sha = sha;
            await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`, { method: 'PUT', headers: {'Authorization':`token ${token}`}, body: JSON.stringify(body) });
        }
    </script>
</body>
</html>
